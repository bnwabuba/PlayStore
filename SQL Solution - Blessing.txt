--Question 1
--Which Apps have the highest rating

SELECT App, Rating
FROM `my-data-project-12345-351415.Playstore.apps_data` 
WHERE Rating = (SELECT MAX(Rating)
FROM `my-data-project-12345-351415.Playstore.apps_data`)


-- QUESTION 2 

-- What are the number of installs and reviews for the above apps? return the apps with the highest reviews to the top --

SELECT App, Rating, Installs, Reviews
FROM `my-data-project-12345-351415.Playstore.apps_data`
WHERE Rating = (SELECT MAX(Rating)
FROM `my-data-project-12345-351415.Playstore.apps_data`)
ORDER BY Reviews DESC


-- QUESTION 3
-- Which app has the highest number of reviews? Also mention the number of reviews and category of the app

SELECT App, MAX(Reviews) AS Maximum_reviews, Category
FROM `my-data-project-12345-351415.Playstore.apps_data`
GROUP BY App, Category

-- Question 4
-- What is the total amount of revenue generated by the google playstore by hosting apps
SELECT SUM(price) AS total_amount_of_revenue
FROM `my-data-project-12345-351415.Playstore.apps_data`
WHERE type = "Paid";


-- Question 5
-- Which category of google playstore has the highest number of installs? Also find out the total number of installs for that category

SELECT Category, MAX(Installs) AS highest_number_of_installs
FROM `my-data-project-12345-351415.Playstore.apps_data`
GROUP BY Category
LIMIT 1;


-- Question 6
-- Which Genre has the most number of published apps?

SELECT COUNT(Genres) AS number_of_apps, Genres
FROM  `my-data-project-12345-351415.Playstore.apps_data`
GROUP BY Genres
ORDER BY number_of_apps DESC;


-- Question 7 
-- 7. Provide the list of all games ordered in such a way that the game that has the highest number of installs is displayed on the top (to avoid duplicate results use distinct)

SELECT DISTINCT (App), Installs
FROM  `my-data-project-12345-351415.Playstore.apps_data`
WHERE Category = "GAME"
GROUP BY App, Installs
ORDER BY Installs DESC;


-- Question 8
-- Provide the list of apps that can work on android version 4.0.3 and UP.

SELECT App
FROM `my-data-project-12345-351415.Playstore.apps_data`
WHERE Android_Ver = "4.0.3 and up";


-- Question 9
-- How many apps from the given data set are free? Also, provide the number of paid apps.

SELECT COUNT(App) AS Apps, Type
FROM `my-data-project-12345-351415.Playstore.apps_data`
WHERE Type = 'Free' OR Type = 'Paid'
GROUP BY Type;


-- Question 10 
-- Which is the best dating app? (Best dating app is the one having the highest number of Reviews)

SELECT App, Reviews
FROM `my-data-project-12345-351415.Playstore.apps_data`
WHERE Genres = "Dating"
ORDER BY Reviews DESC
LIMIT 1;


-- Question 11
-- Get the number of reviews having positive sentiment and number of reviews having negative sentiment for the app 10 best foods for you and compare them.

WITH B AS (SELECT *,
CASE WHEN Sentiment = "Positive" THEN 1 ELSE 0 END AS positive_sentiment,
CASE WHEN Sentiment = "Negative" THEN 1 ELSE 0 END AS negative_sentiment
FROM `my-data-project-12345-351415.Playstore.review_data`
WHERE App = "10 Best Foods for You" )
SELECT SUM(positive_sentiment) AS total_positive_sentiment, SUM(negative_sentiment) AS total_negative_sentiment
FROM B;


-- Question 12
-- Which comments of ASUS SuperNote have sentiment polarity and sentiment subjectivity both as 1?

SELECT App, Translated_Review AS Comment, Sentiment_Polarity, Sentiment_Subjectivity
FROM `my-data-project-12345-351415.Playstore.review_data`
WHERE App = 'ASUS SuperNote' AND Sentiment_polarity = 1 AND Sentiment_Subjectivity = 1;


-- Question 13
-- Get all the neutral sentiment reviews for the app Abs Training-Burn belly fat 

SELECT App, Sentiment AS Sentiment_reviews, Translated_Review
FROM `my-data-project-12345-351415.Playstore.review_data`
WHERE App = "Abs Training-Burn belly fat" AND Sentiment = "Neutral";


-- Question 14
-- Extract all negative sentiment reviews for Adobe Acrobat Reader with their sentiment polarity and sentiment subjectivity

SELECT App, Sentiment AS Sentiment_reviews, Sentiment_Polarity, Sentiment_Subjectivity
FROM `my-data-project-12345-351415.Playstore.review_data`
WHERE App = "Adobe Acrobat Reader" AND Sentiment = "Negative";

